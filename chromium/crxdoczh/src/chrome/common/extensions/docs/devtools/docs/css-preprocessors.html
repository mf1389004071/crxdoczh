{{+bindTo:partials.standard_devtools_article}}
<h1><!--@Working with CSS Preprocessors-->与 CSS 预处理器协作</h1>

<p><!--@Many developers generate CSS style sheets using a CSS preprocessor, such as Sass, Less, or Stylus. Because the
CSS files are generated, editing the CSS files directly is not as helpful.-->
许多开发者使用 CSS 预处理器，例如 Sass、Less 或 Stylus 生成 CSS 样式。因为
CSS 文件是程序生成的，直接编辑 CSS 文件没有太大的用处。</p>

<p><!--@For preprocessors that support CSS source maps, DevTools lets you live-edit
your preprocessor source files in the Sources panel, and view the results without having to leave DevTools or refresh the page. When you inspect an element whose styles are provided by a generated CSS file, the Elements panel displays a link to the original source file,  not the generated .css file.-->
对于支持 CSS 源代码映射的预处理器来说，开发者工具允许您在源代码面板实时编辑预处理源文件并查看结果，而不需要离开开发者工具或刷新网页。当您审查某个元素时，如果它的样式由生成的
CSS 文件提供，元素面板会显示原始源文件链接，而不是生成的 .css 文件。</p>

<figure class="screenshot"> <img src="css-preprocessors-files/sass-debugging.png" alt="Elements panel showing .scss stylesheet" /></figure>

<p><!--@To jump to the source file: -->要跳转到源文件：</p>
<ul>
<li><!--@Click the link to open the (editable) source file in the Sources panel.-->单击链接，在源代码面板中打开（可编辑的）源文件。</li>
<li><!--@<b>Control+click</b> (or <b>Command+click</b>) on any CSS property name or value to open the source file and jump to the appropriate line.-->
<b>Control/Command</b>+单击任意 CSS 属性名称或值，打开源文件并跳转到相应行号。</li>
</ul>

<figure class="screenshot"><img src="css-preprocessors-files/sass-sources.png" alt="Sources panel showing .scss file" /></figure>

<p><!--@When you save changes to a CSS preprocessor file in DevTools, the CSS preprocessor should re-generate the
CSS files. Then DevTools reloads the newly-generated CSS file. -->
当您在开发者工具中保存 CSS 预处理文件的更改时，CSS 预处理器应该重新生成 CSS
文件，然后开发者工具重新加载新生成的 CSS 文件。</p>

<aside class="note"><!--@Changes made in an <em>external</em> editor are not detected by DevTools until the Sources tab
containing the associated source file regains focus. Also, manual editing of a CSS file generated by the Sass/LESS/other compiler will break the source map association until the page is reloaded.-->
包含相关源文件的源代码标签页重新得到焦点前，<em>外部</em>编辑器中进行的更改不会被开发者工具检测到。此外，手动编辑 Sass/LESS/其他编译器生成的 CSS 文件会破坏源代码映射关系，直到网页重新加载才能恢复正常。</aside>

<aside class="note"><!--@If you're using Workspaces, you'll need to make sure the generated CSS file is also mapped into the workspace. You can verify this by looking in Sources panel right-side tree, and seeing the CSS is from your local folder.-->
如果您使用工作空间，您需要确保生成的 CSS 文件也映射到工作空间中。要确认这一点，您可以查看源代码面板左侧的树，应该能看到 CSS 文件是在本地文件夹中。</aside>


<div class="collapsible">
<h2 id="toc-requirements"><!--@Requirements-->要求</h2>

<p><!--@There are a few requirements to note when working with a CSS preprocessor:-->与 CSS 预处理器协作时有一些要求需要注意：</p>

<ul>
<li><p><!--@To use this workflow, your CSS preprocessor must support CSS source maps, specifically the Source Map v3 proposal. The CSS source maps must be built
along with the CSS files, so DevTools can map each CSS property to the correct location in the original source file
(for example, .scss file).-->要使用这种工作流程，您的 CSS 预处理器必须支持
CSS 源代码映射，更具体地说，源代码映射 v3 提议。CSS 源代码映射必须和 CSS
文件一起建立，这样开发者工具才能将每一个 CSS 属性都映射到原始源文件（例如
.scss 文件）的正确位置。</p></li>

<li><p><!--@For the DevTools to automatically reload styles when you change the source file, your preprocessor must be set up to
regenerate CSS files whenever a source file changes.  Otherwise, you must regenerate CSS files manually and reload the
page to see your changes.-->
为了让开发者工具在您更改源文件后自动重新加载样式，您的预处理器必须设置为每当源文件更改时就重新生成
CSS 文件，否则您必须手工重新生成 CSS 文件，并重新加载网页才能看到更改。</p></li>

<li><p>
<!--@You must be accessing your site or app from a web server (not a <b>file://</b> URL), and
the server must serve the CSS files as well as the source maps (.css.map) and source files (.scss, etc.).-->
您必须从网络服务器（不是 <b>file://</b> URL）访问您的网站或应用，而且服务器必须同时托管
CSS 文件、源代码映射（.css.map）和源文件（.scss 等）。
</p></li>
<li>
<p>
<!--@If you are <em>not</em> using the Workspaces feature, the web server must also supply the
<code>Last-Modified</code> header. The Python <code>SimpleHTTPServer</code> module provides this header by default.
You can start a web server to serve the contents of the current directory like this:-->
如果您<em>没有</em>使用工作空间特性，网络服务器还必须提供
<code>Last-Modified</code> 标头。Python 的 <code>SimpleHTTPServer</code>
模块默认情况下提供这种标头，您可以像这样启动网络服务器，托管当前目录下的内容：</p>
<pre class="prettyprint">python -m SimpleHTTPServer</pre>
</li>
</ul>

</div>
<div class="collapsible">
<h2 id="toc-enabling-css-source-maps"><!--@Enabling CSS source maps-->启用 CSS 源代码映射</h2>

<p><!--@CSS source maps are enabled by default. You can choose to
enable automatic reloading of generated CSS files. -->
CSS 源代码映射默认情况下就是启用的，您可以选择自动重新加载生成的 CSS 文件。</p>

<p><strong><!--@To enable CSS source maps and CSS reload:-->要启用 CSS 源代码映射和 CSS 重新加载：</strong></p>

<ol>
<li><p><!--@Open DevTools Settings and click <b>General</b>.-->打开开发者工具设置，并单击 <b>General</b>（常用）。</p></li>
<li><p><!--@Turn on-->选中 <b>Enable CSS source maps</b><!--@ and-->（启用
CSS 源代码映射）和 <b>Auto-reload generated CSS</b><!--@.-->（自动重新加载生成的
CSS）。</p></li>
</ol>


</div>
<div class="collapsible">
<h2 id="toc-using-css-source-maps"><!--@Using Sass with CSS source maps-->在 Sass 中使用 CSS 源代码映射</h2>

<p><!--@To live-edit Sass files in Chrome you need to have the <a href="http://sass-lang.com/download.html">pre-release version of the Sass compiler</a>, which is the only version that currently supports source map generation.-->
为了在 Chrome 浏览器中实时编辑 Sass 文件，您需要
<a href="http://sass-lang.com/install">Sass
编译器 3.3.0 或更高版本</a>，支持生成源代码映射文件。</p>

<pre class="prettyprint">gem install sass -v '>=3.3.0alpha' --pre</pre>


<p><!--@Once Sass is installed, start the Sass compiler to watch for changes to your Sass source files and create source map files for each generated CSS file, for example: -->
Sass 安装完成后，启动 Sass 编译器，监视 Sass 源文件的更改，并为每一个生成的
CSS 文件创建源代码映射文件。例如：</p>

<pre class="prettyprint">sass --watch <b>--sourcemap</b> sass/styles.scss:styles.css</pre>

<p><!--@If you are using Compass, note that Compass doesn’t yet support the pre-release version of Sass, so you can’t use Sass debugging with Compass.-->如果您使用 Compass，注意 Compass 还不支持 Sass 的预发行版本，所以您不能和
Compass 一起使用 Sass 调试。</p>

</div>
<div class="collapsible">
<h2 id="toc-css-preprocessor-support"><!--@CSS preprocessor support-->CSS 预处理器支持</h2>

<p><!--@DevTools supports the-->开发者工具支持 <a href="https://docs.google.com/a/google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit#">Source Map Revision 3 <!--@proposal-->提议</a><!--@. This proposal is being implemented in several CSS preprocessors:-->，一些
CSS 预处理器正在实现该提议：</p>

<ul>
<li>Sass<!--@: As described above, this is supported in the prerelease version of Sass.-->：如上所述，Sass 3.3.0 及更高版本支持。</li>
<li>Compass<!--@: -->：<a href="https://github.com/chriseppstein/compass/blob/master/compass-style.org/content/CHANGELOG.markdown#100alpha16-12052013"><!--@Implemented in-->在 compass 1.0.0.alpha.16<!--@.--> 中实现</a>。
<li>Less<!--@: Implemented in 1.5.0. See -->在 1.5.0 中实现，有关详情和使用方式请参见<a href="https://github.com/less/less.js/issues/1050#issuecomment-25566463"><!--@issue-->问题 #1050</a><!--@ for details and usage patterns.-->。</li>
<li>Autoprefixer<!--@: Implemented in 1.0. -->在 1.0 中实现。<a href="https://github.com/ai/autoprefixer#source-map">Autoprefixer <!--@docs-->文档</a><!--@ explain how to use it, along with absorbing an input sourcemap (from another preprocessor).-->解释了它的使用方法以及如何（从另一个预处理器）吸收源代码映射。</li>
<li>Libsass<!--@: -->：<a href="https://github.com/hcatlin/libsass/commit/366bc110c39c26c9267a1cc06e578beb94cd93ef"><!--@Implemented-->已经实现</a><!--@.-->。
<li>Stylus<!--@: Under consideration. See -->正在考虑中，请参见<a href="https://github.com/LearnBoost/stylus/issues/1072"><!--@issue-->问题 #1072</a><!--@.-->。</li>
</ul>

</div>
<div class="collapsible">
<h2 id="toc-how-css-source-maps-work"><!--@How CSS source maps work-->CSS 源代码映射的工作方式</h2>

<p><!--@For each CSS file it produces, the preprocessor generates a <a href="http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/">source map</a> file (.map file) in addition to the compiled CSS. The source map file is a JSON file that
defines a mapping between each generated CSS declaration and the corresponding line of the source file. Each CSS file contains an annotation that specifies the URL of its source map file, embedded in a special comment on the
last line of the file:-->
预处理器每产生一个编译后的 CSS 文件，同时生成一个<a href="http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/"
>源代码映射</a>文件（.map 文件）。源代码映射文件是一个 JSON 文件，定义生成的
CSS 声明与源文件中对应行的映射关系。每一个 CSS
文件都包含一条注记，指定源代码映射文件的 URL，以特殊注释的形式在文件的最后一行嵌入：</p>

<pre class="prettyprint">
/*# sourceMappingURL=&lt;url&gt; */
</pre>

<p><!--@For instance, given an SCSS file named-->例如，给出名为 <b>styles.scss</b><!--@:--> 的 SCSS 文件：</p>

<pre class="prettyprint lang-css">
$textSize: 26px;
$fontColor: red;
$bgColor: whitesmoke;

h2 {
    font-size: $textSize;
    color: $fontColor;
    background: $bgColor;
}
</pre>

<p>Sass <!--@generates a CSS file,-->生成一个 CSS 文件 <b>styles.css</b><!--@, with the-->，包含 sourceMappingURL <!--@annotation:-->注记：</p>

<pre class="prettyprint lang-css">
h2 {
  font-size: 26px;
  color: red;
  background-color: whitesmoke;
}
/*# sourceMappingURL=styles.css.map */
</pre>

<p><!--@Below is an example source map file:-->如下是源代码映射文件的例子：</p>

<pre class="prettyprint">
{
  "version": "3",
  "mappings":"AAKA,EAAG;EACC,SAAS,EANF,IAAI;EAOX,KAAK"
  "sources": ["sass/styles.scss"],
  "file": "styles.css"
}
</pre>

</div>
<div class="collapsible">
<h2 id="toc-resources"><!--@Resources-->资源</h2>

<p><!--@Many users have developed their own workflows using CSS preprocessors.
See the following external articles for tutorials and alternate workflows.-->
许多用户开发了他们自己使用 CSS 预处理器的工作流程，有关教程和其他工作方式请参见以下外部文章。
</p>

<ul>
<li><a href="https://medium.com/what-i-learned-building/b4daab987fb0">Getting started with CSS sourcemaps and in-browser Sass editing</a>（CSS 源代码映射和浏览器内 Sass 编辑入门）</li>
<li><a href="http://benfrain.com/add-sass-compass-debug-info-for-chrome-web-developer-tools/">Faster Sass debugging and style iteration with source maps, Chrome Web Developer Tools and Grunt</a>（使用源代码映射、Chrome
网页开发者工具和 Grunt 更快地进行 Sass 调试和样式调整）</li>
</ul>

<aside class="note"><strong><!--@Note:-->注：</strong><!--@ External resources may not reflect the latest version of Chrome.-->外部资源不一定反映的是 Chrome 浏览器的最新版本。</aside>
</div>
{{/partials.standard_devtools_article}}
